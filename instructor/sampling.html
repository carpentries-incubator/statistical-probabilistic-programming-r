<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Statistical and Probabilistic Programming: Working with samples</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #383838">Pre-Alpha
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="color: #FF4955; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../sampling.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Statistical and Probabilistic Programming
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Statistical and Probabilistic Programming
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Statistical and Probabilistic Programming
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 25%" class="percentage">
    25%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 25%" aria-valuenow="25" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../sampling.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="setup.html">1. Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="bayesian-statistics.html">2. Bayesian Statistics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Working with samples
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#example-binomial-model">Example: binomial model</a></li>
<li><a href="#predictive-distributions">Predictive distributions</a></li>
<li><a href="#posterior-intervals">Posterior intervals</a></li>
<li><a href="#reading">Reading</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="stan.html">4. Stan</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="mcmc.html">5. MCMC</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="hierarchical-models.html">6. Hierarchical Models</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="model-checking.html">7. Model checking</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="advanced-topics.html">8. Advanced topics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/bayesian-statistics.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/stan.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/bayesian-statistics.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Bayesian Statistics</a>
        <a class="chapter-link float-end" href="../instructor/stan.html" rel="next">Next: Stan... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Working with samples</h1>
        <p> Last updated on 2023-06-02 | 
        
        <a href="https://github.com/carpentries-incubator/statistical-probabilistic-programming-r/edit/main/episodes/sampling.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 12 minutes </p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do you work with posterior samples?</li>
<li>How can the posterior information be handled?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Learn how to
<ul><li>work with posterior samples</li>
<li>compute posterior intervals</li>
<li>compute probabilities for parameter ranges and sets</li>
</ul></li>
</ul></div>
</div>
</div>
</div>
</div>
<p>In the previous episode, we were introduced to the Bayesian formula
and learned how to fit binomial and normal models using the grid
approximation. However, the poor scalability of the grid approximation
makes it impractical to use on models of even moderate size. To overcome
this challenge, the standard solution is to employ Markov chain Monte
Carlo (MCMC) methods, which involve drawing random samples from the
posterior distribution. While we will delve into MCMC methods in
subsequent lessons, we will now learn working with samples.</p>
<section id="example-binomial-model"><h2 class="section-heading">Example: binomial model<a class="anchor" aria-label="anchor" href="#example-binomial-model"></a>
</h2>
<hr class="half-width"><p>Let’s revisit the binomial model considered in the previous episode.
The binomial model with a beta distribution is an example of a model
where the analytical shape of the posterior is known.</p>
<p><span class="math display">\[p(\theta | X) = Beta(\alpha + x, \beta +
N - x),\]</span> where <span class="math inline">\(\alpha\)</span> and
<span class="math inline">\(\beta\)</span> are the hyperparameters of
the Beta prior and <span class="math inline">\(x\)</span> the number of
successes out of <span class="math inline">\(N\)</span> trials.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Derive the analytical posterior distribution for the Beta-Binomial
model.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><span class="math display">\[\begin{align}
p(\theta | X) &amp;\propto  p(X | \theta) p(\theta) \\
              &amp;= ...
\end{align}\]</span></p>
</div>
</div>
</div>
</div>
<p>Let’s generate samples from the prior and posterior distributions,
using the handedness data of the previous episode. First redefine the
data.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># 7/50 are left-handed</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></code></pre>
</div>
<p>Then, we’ll draw 5000 samples from the prior and posterior
distributions. In R, the standard statistical distributions can be
sampled from using readily available functions. For instance, the
binomial, normal and beta distributions can be sampled, respectively,
with <code>rbinom, rnorm</code> and <code>rbeta</code> functions.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of samples</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span></span>
<span><span class="co"># Prior is Beta(1, 10)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Draw random values from the prior</span></span>
<span><span class="va">prior_samples</span> <span class="op">&lt;-</span> <span class="fu">rbeta</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                       shape1 <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                       shape2 <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw random values from the posterior</span></span>
<span><span class="va">posterior_samples</span> <span class="op">&lt;-</span> <span class="fu">rbeta</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                           shape1 <span class="op">=</span> <span class="va">alpha</span> <span class="op">+</span> <span class="va">x</span>, </span>
<span>                           shape2 <span class="op">=</span> <span class="va">beta</span> <span class="op">+</span> <span class="va">N</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples_df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>prior <span class="op">=</span> <span class="va">prior_samples</span>, </span>
<span>                         posterior <span class="op">=</span> <span class="va">posterior_samples</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s plot histograms for these samples along with the analytical
densities, the normalized likelihood, and the “true” value (blue) based
on a larger population sample.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wide --&gt; long format</span></span>
<span><span class="va">samples_df_w</span> <span class="op">&lt;-</span> <span class="va">samples_df</span> <span class="op">%&gt;%</span> <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define analytical distributions</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">analytical_df</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>p <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    prior <span class="op">=</span> <span class="fu">dbeta</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span> , <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, </span>
<span>    posterior <span class="op">=</span> <span class="fu">dbeta</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span> , <span class="va">alpha</span> <span class="op">+</span> <span class="va">x</span>, <span class="va">beta</span> <span class="op">+</span> <span class="va">N</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span>, </span>
<span>    likelihood <span class="op">=</span> <span class="fu">dbinom</span><span class="op">(</span>size <span class="op">=</span> <span class="va">N</span>, x <span class="op">=</span> <span class="va">x</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>likelihood <span class="op">=</span> <span class="va">likelihood</span><span class="op">/</span><span class="op">(</span><span class="fu">sum</span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span><span class="op">*</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># normalize likelihood for better presentation</span></span>
<span>  <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="st">"Analytical function"</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># wide --&gt; long</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>`Analytical function` <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">`Analytical function`</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"posterior"</span>, <span class="st">"prior"</span>, <span class="st">"likelihood"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Frequency in a large population sample (Hardyck, C. et al., 1976)</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">9.6</span><span class="op">/</span><span class="fl">100</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">samples_df_w</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span>,</span>
<span>                     fill <span class="op">=</span> <span class="va">Samples</span><span class="op">)</span>,</span>
<span>                 bins <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                 position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">analytical_df</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">p</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">`Analytical function`</span><span class="op">)</span>, </span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">p_true</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_grafify</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_grafify</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/sampling-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>When sampling the prior and posterior, it is important to draw
sufficiently many samples to get an accurate representation of the true
density. Typically, this means drawing at least some thousands of
samples.</p>
</section><section id="predictive-distributions"><h2 class="section-heading">Predictive distributions<a class="anchor" aria-label="anchor" href="#predictive-distributions"></a>
</h2>
<hr class="half-width"><p>The posterior distribution gives probabilities for the model
parameters conditional on the data which is information regarding the
data generative process. However, it can also be valuable to analyze
what sort of observations might be expected to arise if more data was
gathered. On the other hand this might be an interesting question to
address based simply on the prior beliefs.</p>
<p>The posterior and prior predictive distributions aim to address this
question. They give probabilities for new observations based on the
prior, model and currently available data. Prior predictions do not use
the data, however.</p>
<p>The prior predictive distribution (also known as marginal
distribution of data) is defined as</p>
<p><span class="math display">\[p(y) = \int p(\theta)p(y | \theta) d
\theta.\]</span></p>
<p>In this course, we will not be using the analytical formula or make
derivations for any models. The key point here is to be able to simulate
from <span class="math inline">\(p(y)\)</span>. This can be done by
first drawing a sample from the prior <span class="math inline">\(p(\theta)\)</span> and then using this sample to
generate data based on <span class="math inline">\(p(y |
\theta).\)</span> Let’s generate some data based on the Beta-binomial
model of the handedness example and plot a histogram of <span class="math inline">\(y.\)</span></p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Draw from the prior</span></span>
<span><span class="va">prior_samples2</span> <span class="op">&lt;-</span> <span class="fu">rbeta</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                        shape1 <span class="op">=</span> <span class="va">a</span>,</span>
<span>                        shape2 <span class="op">=</span> <span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data based on the prior samples</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_samples</span>, size <span class="op">=</span> <span class="fl">50</span>, prob <span class="op">=</span> <span class="va">prior_samples2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p_y</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, </span>
<span>                 <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, </span>
<span>                 binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">p_y</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/sampling-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Discuss the logic of the sampling process.</p>
<p>What does the distribution tell you?</p>
<p>In the example above, we used <code>size = 50</code>. What is the
significance of this and could we have used some other value?</p>
<p>Play around with different parameter values.</p>
</div>
</div>
</div>
<p>The posterior predictive distribution is defined as</p>
<p><span class="math display">\[p(\tilde{y} | y) = \int p(\tilde{y} |
\theta)p(\theta | y) d \theta.\]</span></p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>How do you generate samples from the posterior predictive
distribution <span class="math inline">\(p(\tilde{y} | y)\)</span></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The posterior predictive distribution can be samples as follows:</p>
<ol style="list-style-type: decimal"><li>Draw sample from the posterior <span class="math inline">\(p(\theta
| y)\)</span>
</li>
<li>Generate observations based on <span class="math inline">\(p(\tilde{y} | \theta)\)</span>
</li>
</ol></div>
</div>
</div>
</div>
<p>Let’s simulate the posterior predictive distribution.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">posterior_samples2</span> <span class="op">&lt;-</span> <span class="fu">rbeta</span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                           shape1 <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">x</span>, </span>
<span>                           shape2 <span class="op">=</span> <span class="va">b</span> <span class="op">+</span> <span class="va">N</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Generate data based on the prior samples</span></span>
<span><span class="va">y_tilde</span> <span class="op">&lt;-</span> <span class="fu">rbinom</span><span class="op">(</span><span class="va">n_samples</span>, size <span class="op">=</span> <span class="fl">50</span>, prob <span class="op">=</span> <span class="va">posterior_samples2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p_y_tilde</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">y_tilde</span><span class="op">)</span>, </span>
<span>                 <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_tilde</span><span class="op">)</span>, </span>
<span>                 binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">p_y_tilde</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/sampling-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="posterior-intervals"><h2 class="section-heading">Posterior intervals<a class="anchor" aria-label="anchor" href="#posterior-intervals"></a>
</h2>
<hr class="half-width"><p>In Episode 1, we summarized the posterior with the posterior mode
(MAP), mean and variance. While these points estimates are informative
and often utilized, they and not informative enough for many
scenarios.</p>
<p>More specified information about the posterior can be communicated
with <em>credible intervals</em> (CI). These intervals refer to areas of
the space where a certain amount of posterior mass is located. Usually
CIs are computed as quantiles of posterior, so for instance the 90% CI
would be located between the 5% and 95% percentiles.</p>
<p>Let us now compute the percentile-based CIs for the handedness
example, along with the posterior mode (MAP), and include them in the
figure. The x-axis is zoomed so for clarity.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MAP</span></span>
<span><span class="va">posterior_density</span> <span class="op">&lt;-</span> <span class="fu">density</span><span class="op">(</span><span class="va">posterior_samples</span><span class="op">)</span></span>
<span><span class="va">MAP</span> <span class="op">&lt;-</span> <span class="va">posterior_density</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu">which.max</span><span class="op">(</span><span class="va">posterior_density</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># 90% credible interval</span></span>
<span><span class="va">CIs</span> <span class="op">&lt;-</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">posterior_samples</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">CIs</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">MAP</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">p_true</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Black = MAP and 90% CIs"</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/sampling-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The 90% interval in this example is 0.07, 0.21 which means that,
according to the analysis, there is a 90% probability that the
proportion of left-handed people is between these values.</p>
<p>Another approach to reporting posterior information is to find the
amount of the posterior mass in a given interval (or some more general
set). This approach enables determining probabilities for hypotheses.
For instance, we might be interested in knowing the probability that the
target parameter is less than 0.2, between 0.05 and 0.10, or less than
0.1 or greater than 0.20. Such probabilities can be recovered based on
samples simply by computing the proportion of samples in these sets.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_less_than_0.15</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">posterior_samples</span> <span class="op">&lt;</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="va">p_between_0.05_0.1</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">posterior_samples</span> <span class="op">&gt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="va">posterior_samples</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">p_outside_0.1_0.2</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">posterior_samples</span> <span class="op">&lt;</span> <span class="fl">0.1</span> <span class="op">|</span> <span class="va">posterior_samples</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s visualize these probabilities as shaded areas of the analytical
posterior:</p>
<figure><img src="../fig/sampling-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion2"></a>
</h3>
<div class="callout-content">
<p>How would you compute CIs based on an analytical posterior
density?</p>
<p>Can you draw samples from the likelihood?</p>
</div>
</div>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge3"></a>
</h3>
<div class="callout-content">
<p>Another approach to posterior summarizing to compute the smallest
interval that contains p% of the posterior. Such sets are called highest
posterior density intervals (HPDI). More generally, this set can be a
more general set than an interval.</p>
<p>Write a function that returns the highest posterior density interval
based on a set of posterior samples. Compute the 95% HPDI for the
posterior samples generated (<code>samples_df</code>) and compare it to
the 95% CIs.</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1">
  Give me a hint
  </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>If you sort the posterior samples in order, each set of <span class="math inline">\(n\)</span> consecutive samples contains <span class="math inline">\(100 \cdot n/N \%\)</span> of the posterior, where
<span class="math inline">\(N\)</span> is the total number of
samples.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Let’s write the function for computing the HPDI</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_HPDI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span>, <span class="va">prob</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Total samples</span></span>
<span>  <span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># How many samples constitute prob of the total number?</span></span>
<span>  <span class="va">prob_samples</span> <span class="op">&lt;-</span> <span class="fu">round</span><span class="op">(</span><span class="va">prob</span><span class="op">*</span><span class="va">n_samples</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Sort samples</span></span>
<span>  <span class="va">samples_sort</span> <span class="op">&lt;-</span> <span class="va">samples</span> <span class="op">%&gt;%</span> <span class="va">sort</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Each samples_sort[i:(i + prob_samples - 1)] contains prob of the total distribution mass</span></span>
<span>  <span class="co"># Find the shortest such interval </span></span>
<span>  <span class="va">min_i</span> <span class="op">&lt;-</span> <span class="fu">lapply</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_samples</span> <span class="op">-</span> <span class="va">prob_samples</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">samples_sort</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="va">prob_samples</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">samples_sort</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist</span> <span class="op">%&gt;%</span> <span class="fu">which.min</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Get correspongind values</span></span>
<span>  <span class="va">hpdi</span> <span class="op">&lt;-</span> <span class="va">samples_sort</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="va">min_i</span>, <span class="va">min_i</span> <span class="op">+</span> <span class="va">prob_samples</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">hpdi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Then we can compute the 95% HPDI and compare it to the corresponding
CIs</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span>HPDI <span class="op">=</span> <span class="fu">get_HPDI</span><span class="op">(</span><span class="va">samples_df</span><span class="op">$</span><span class="va">posterior</span>, <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>           CI <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">posterior_samples</span>, probs <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">t</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">data.frame</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>length <span class="op">=</span> <span class="va">X97.5.</span> <span class="op">-</span> <span class="va">X2.5.</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          X2.5.    X97.5.    length
HPDI 0.05363662 0.2149255 0.1612888
CI   0.06056575 0.2254913 0.1649256</code></pre>
</div>
<p>Both intervals contain the same mass but the HPDI is (slightly)
shorter.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Being able to sample from distributions make working with Bayesian
models a lot more straight-forward</li>
<li>Prior/posterior predictive distributions describe the type of data
we’d expect to encounter based on prior/posterior information.</li>
<li>The posterior distribution can be summarized with point estimates or
computing the posterior mass in some set.</li>
<li>The credible intervals can be computed based on samples using
posterior quantiles</li>
<li>Probability of a parameter being in a set can be computed as the
proportion of samples within the particular set.</li>
</ul></div>
</div>
</div>
</section><section id="reading"><h2 class="section-heading">Reading<a class="anchor" aria-label="anchor" href="#reading"></a>
</h2>
<hr class="half-width"><ul><li>Gelman <em>et al.</em>, Bayesian Data Analysis (3rd ed.):
<ul><li>p. 7: Prediction</li>
<li>p. 23: Simulation of posterior and …</li>
</ul></li>
<li>McElreath, Statistical Rethinking (2nd ed.): Ch. 3</li>
</ul><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 --></section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/bayesian-statistics.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/stan.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/bayesian-statistics.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous: Bayesian Statistics</a>
        <a class="chapter-link float-end" href="../instructor/stan.html" rel="next">Next: Stan... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries-incubator/statistical-probabilistic-programming-r/edit/main/episodes/sampling.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries-incubator/statistical-probabilistic-programming-r/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/carpentries-incubator/statistical-probabilistic-programming-r/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/statistical-probabilistic-programming-r/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:velait@utu.fi">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.12.2" class="external-link">sandpaper (0.12.2)</a>,
        <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.5.3)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.17" class="external-link">varnish (0.2.17)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/statistical-probabilistic-programming-r/instructor/sampling.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Working with samples",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/statistical-probabilistic-programming-r/instructor/sampling.html",
  "identifier": "https://carpentries-incubator.github.io/statistical-probabilistic-programming-r/instructor/sampling.html",
  "dateCreated": "2023-06-02",
  "dateModified": "2023-06-02",
  "datePublished": "2023-06-02"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

